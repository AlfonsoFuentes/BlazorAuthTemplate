@page "/registerform"
@using Shared.Dtos.Requests
@using Shared.Dtos.Responses

@layout MainLayout
@attribute [AllowAnonymous]
<EditForm Model="@Model" OnValidSubmit="SubmitAsync">

    <DataAnnotationsValidator></DataAnnotationsValidator>
    <MudCard>
        <MudCardContent Style="d-flex justify-center">
            <MudGrid Justify="Justify.Center" Spacing="2">

                <MudItem xs="12" Class="d-flex justify-center">
                    <MudText Typo="Typo.h4"><strong>CP Plant Simulator</strong></MudText>
                </MudItem>
                <MudItem xs="12" Class="d-flex justify-center">
                    <MudText>Interactive Software to Simulate Finishing Lines</MudText>
                </MudItem>
                <MudItem xs="12" Class="d-flex justify-center">
                    <MudText>Colgate-Palmolive - Cali</MudText>
                </MudItem>
                <MudItem xs="12" Class="d-flex justify-center">
                    <MudText>
                        Already have an account? <MudLink Href="login">Sign In here</MudLink>
                    </MudText>
                </MudItem>
                <MudItem xs="12" sm="4">
                </MudItem>
                <MudItem xs="12" sm="4">
                    <MudTextField Label="UserName" @bind-Value="@Model.UserName"></MudTextField>
                </MudItem>
                <MudItem xs="12" sm="4">
                </MudItem>
                  <MudItem xs="12" sm="4">
                </MudItem>
                <MudItem xs="12" sm="4">
                    <MudTextField Label="Email" @bind-Value="@Model.Email" InputType="InputType.Email"></MudTextField>
                </MudItem>
                <MudItem xs="12" sm="4">
                </MudItem>
                <MudItem xs="12" sm="4">
                </MudItem>
                <MudItem xs="12" sm="4">
                    <MudTextField Label="Password" @bind-Value="@Model.Password" InputType="InputType.Password"></MudTextField>
                </MudItem>
                <MudItem xs="12" sm="4">
                </MudItem>
                <MudItem xs="12" sm="4">
                </MudItem>
                <MudItem xs="12" sm="4">
                    <MudTextField Label="Confirm Password" InputType="InputType.Password" @bind-Value="@Model.Password"></MudTextField>
                  

                </MudItem>
                <MudItem xs="12" sm="4">
                </MudItem>

            </MudGrid>
        </MudCardContent>
        <MudCardActions Class="d-flex justify-center">
            <MudButton ButtonType="ButtonType.Submit" Variant="Variant.Filled">Sign In</MudButton>
        </MudCardActions>
    </MudCard>





</EditForm>
@if (loginResponse.Messages.Count > 0)
{
    foreach (var row in loginResponse.Messages)
    {
        @row
    }
}


@code {

    RegistrationRequest Model = new();
    StatusResponse loginResponse = new();
    
    async Task SubmitAsync()
    {

        loginResponse.Message = "Wait....";
        loginResponse = await AuthService.Register(Model);
        if (loginResponse.Code == 1)
            NavManager.NavigateTo("/");

    }
    
}
