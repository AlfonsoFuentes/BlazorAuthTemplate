@* ScopeDialog.razor *@  
@inherits ComponentBase

<TemplateDialog TValue="ScopeDto"
                Model="@Model"
                OnSubmit="Submit"
                OnCancel="Cancel">

    <Content Context="ctx">
        <MudGrid>
            <MudItem xs="12">
                <TextField @bind-Value="@ctx.Model.Name"
                           Label="Name"
                           Lines="3"
                           ValidateAsync="@ctx.ValidateAsync"
                           For="@(() => ctx.Model.Name)">
                </TextField>

            </MudItem>
        </MudGrid>
    </Content>

</TemplateDialog>

@code {
    [CascadingParameter] private IMudDialogInstance MudDialog { get; set; } = null!;
    [Parameter] public ScopeDto Model { get; set; } = new();

    protected override async Task OnInitializedAsync()
    {
        // Solo carga si es edición
        if (Model.Id != Guid.Empty)
        {
            var result = await HttpService.PostAsync<GetScopeById, GeneralDto<EditScope>>(
                new GetScopeById { Id = Model.Id });

            if (result.Succeeded && result.Data != null)
            {
                Model.Name = result.Data.Name;
                Model.Order = result.Data.Order;
                // Si tu EditScope tiene más props, asigna aquí
            }
        }
    }

    private async Task Submit()
    {
        var result = await HttpService.PostAsync<ScopeDto, GeneralDto>(Model);
        if (result.Succeeded)
        {
            MudDialog.Close(DialogResult.Ok(true));
        }
    }

    private void Cancel() => MudDialog.Cancel();

}
